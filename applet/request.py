# Import libraries
from mitmproxy import http
from mitmproxy import ctx

# Set the variables
ran = False

# Run the proxy server
def request(flow: http.HTTPFlow) -> None:
    global ran

    if '192.168.0.0' in flow.request.pretty_host:
        if not ran:
            ctx.log.info('Target host IP detected')
            ctx.log.info('Redirecting...')
            flow.request.host = '192.168.0.1'
            ran = True
